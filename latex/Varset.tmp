%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\section{Chanset and Nameset Expressions}
\label{sec:chanset-expression}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Currently, \verb"{|...|}" is used for chanset comprehension to avoid
confusion with general set comprehensions.

%% \draftnote{Use of ``identifier'' here is almost certainly wrong, if
%%   chanset expressions are meant to become sets of channel names.  How
%%   do we reference channels named \texttt{a.b}, for instance?  Ah well,
%%   this is what we accept.}

\RuleDef{chanset expression}{
  \RuleRef{identifier} \\
  \Alt\ \Literal{\mylcurly}, \Optional{\CommaSepList{\RuleRef{identifier}}}, \Literal{\myrcurly} \\
  \Alt\ \Literal{\mylcurly|}, \Optional{\CommaSepList{\RuleRef{identifier}}}, \Literal{|\myrcurly} \\
  \Alt\ \Literal{\mylcurly |},
          \RuleRef{identifier}, \Optional{\Literal{.} \RuleRef{expression}},
          \Literal{|} \RuleRef{bind list},
          \Optional{\Literal{@}, \RuleRef{expression}},
        \Literal{|\myrcurly} \\
  %% \Alt\ \Literal{\mylcurly |},
  %%         \RuleRef{identifier}, \Sequence{\Literal{.} \RuleRef{expression}},
  %%         \Literal{|} \RuleRef{bind list},
  %%         \Optional{\Literal{@}, \RuleRef{expression}},
  %%       \Literal{|\myrcurly} \\
  \Alt\ \RuleRef{chanset expression}, \Literal{union}, \RuleRef{chanset expression} \\
  \Alt\ \RuleRef{chanset expression}, \Literal{inter}, \RuleRef{chanset expression} \\
  \Alt\ \RuleRef{chanset expression}, \Literal{\mybackslash}, \RuleRef{chanset expression} \\
}

Note that the third alternative --the comprehension-- here only allows
an optional single \RuleRef{expression}, unlike the sequence allowed
in \CML0; this restriction is due to the same ambiguities with `.'
that affect the restrictions in the \RuleRef{renaming pair} rule.

The structure of the \RuleRef{nameset expression} rule is identical to
that of the \RuleRef{chanset expression} rule (and, indeed, the parser
in the tool does not distinguish between them in recognition).

\RuleDef{nameset expression}{
%  is identical to \RuleRef{chanset expression}, replacing nameset for chanset.
  \RuleRef{identifier} \\
  \Alt\ \Literal{\mylcurly}, \Optional{\CommaSepList{\RuleRef{identifier}}}, \Literal{\myrcurly} \\
  \Alt\ \Literal{\mylcurly|}, \Optional{\CommaSepList{\RuleRef{identifier}}}, \Literal{|\myrcurly} \\
  \Alt\ \Literal{\mylcurly |},
          \RuleRef{identifier}, \Optional{\Literal{.} \RuleRef{expression}},
          \Literal{|} \RuleRef{bind list},
          \Optional{\Literal{@}, \RuleRef{expression}},
        \Literal{|\myrcurly} \\
  %% \Alt\ \Literal{\mylcurly |},
  %%         \RuleRef{identifier}, \Sequence{\Literal{.} \RuleRef{expression}},
  %%         \Literal{|} \RuleRef{bind list},
  %%         \Optional{\Literal{@}, \RuleRef{expression}},
  %%       \Literal{|\myrcurly} \\
  \Alt\ \RuleRef{nameset expression}, \Literal{union}, \RuleRef{nameset expression} \\
  \Alt\ \RuleRef{nameset expression}, \Literal{inter}, \RuleRef{nameset expression} \\
  \Alt\ \RuleRef{nameset expression}, \Literal{\mybackslash}, \RuleRef{nameset expression} \\
}


