%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\section{Patterns and Bindings}
\label{sec:patterns-bindings}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Patterns}%\label{patterns2}
\label{sec:patterns}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\RuleDef{pattern}{
  \RuleRef{bindable pattern} \\
  \Alt\ \RuleRef{match value}
}

\RuleDef{bindable pattern}{
  \Literal{-} \\
  \Alt\ \RuleRef{identifier} \\
  \Alt\ \Literal{mk\myunderscore}, \Literal{(}, \RuleRef{pattern}, \Literal{,}, \RuleRef{pattern list}, \Literal{)} \\
  \Alt\ \Literal{mk\myunderscore}, \RuleRef{name}, \Literal{(}, \Optional{\RuleRef{pattern list}}, \Literal{)}
}

\RuleDef{match value}{
  \Literal{(}, \RuleRef{expression}, \Literal{)} \\
  \Alt\ \RuleRef{symbolic literal}
}

\RuleDef{pattern list}{
  \xSepList{,}{\RuleRef{pattern}}
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Bindings}
\label{sec:bindings}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\RuleDef{bind}{
  \RuleRef{set bind} \Alt\ \RuleRef{type bind}
}

\RuleDef{set bind}{
  \RuleRef{pattern}, \Literal{in set}, \RuleRef{expression}
}

\RuleDef{type bind}{
  \RuleRef{pattern}, \Literal{:}, \RuleRef{type}
}

\RuleDef{bind list}{
  \xSepList{,}{\RuleRef{multiple bind}}
}

\RuleDef{multiple bind}{
  \RuleRef{pattern list}, \Literal{in set}, \RuleRef{expression} \\
  \Alt\ \RuleRef{pattern list}, \Literal{:}, \RuleRef{type}
}

\RuleDef{type bind list}{
  \xSepList{,}{\RuleRef{type bind}}
}


